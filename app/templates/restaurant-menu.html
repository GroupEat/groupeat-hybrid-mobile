<ion-view ng-controller='RestaurantMenuCtrl'  title="{{ 'restaurantMenu' | translate }}" hide-back-button="true">

  <ion-nav-buttons side="right">
    <button class="button button-clear ion-ios-cart-outline right-header-bar-icon" ui-sref="cart">
    </button>
  </ion-nav-buttons>

  <ion-nav-buttons side="left">
    <button class="button button-clear ion-ios-arrow-back" on-tap="onLeaveRestaurant()"> {{ 'back' | translate }}
    </button>
  </ion-nav-buttons>

  <ion-content has-header="true" ng-hide="messageBackdrop.show">
    <ion-list>
      <div ng-repeat="product in products">

        <ion-item on-tap="toggleDetails(product)" ng-class="{active: areDetailsShown(product)}" >
          <div class="border-less">
              <b> {{ product.name }} </b>
              <p> {{ product.description }} </p>
          </div>
        </ion-item>

        <ion-item ng-repeat="format in product.formats.data" ng-show="areDetailsShown(product)">
          <div class="row border-less">
            <div ng-show="isNewOrder.value" class="col col-60 border-less">
              {{ format.name }} ({{ format.price }} €)
            </div>
            <div ng-hide="isNewOrder.value" class="col col-60 border-less">
              {{ format.name }} (<strike>{{ format.price }}€</strike> {{ format.price*(100-currentOrder.currentDiscount)/100 | number : 2}} €)
            </div>

            <div class="col col-10 ">
              <a class="ion-ios-minus-outline assertive icon-cart-add-delete align-right" on-tap="onDeleteProduct(product, format.id)"></a>
            </div>
            <div class="col col-10">
              <a class="center">{{ cart.getFormatQuantity(format.id) }}</a>
            </div>
            <div class="col col-10 ">
              <a class="icon ion-ios-plus-outline assertive icon-cart-add-delete" on-tap="onAddProduct(product, format)"></a>
            </div>
            <div class="col col-10 ">
            </div>
          </div>
        </ion-item>
      </div>
    </ion-list>
  </ion-content>

  <ion-content has-header="true" scroll="false" ng-show="messageBackdrop.show">
    <ge-message-backdrop>
    </ge-message-backdrop>
  </ion-content>

  <ion-footer-bar class="bar-energized ">
      <div class="row border-less">
          <div class="col col-25">
            <i class="icon ion-ios7-cart-outline right-footer-bar-icon"></i>  {{ cart.getTotalPrice() | number : 2}}€
          </div>
          <div class="col col-25">
            <ng-pluralize count="cart.getTotalQuantity()" when="{'0': ' 0 Pizza', '1': ' 1 Pizza', 'other': '{{ cart.getTotalQuantity() }} Pizzas'}" ></ng-pluralize>
          </div>
          <div ng-hide="isNewOrder.value" class="col col-25">
            {{ currentOrder.currentDiscount }} %
          </div>
      </div>
   </ion-footer-bar>

</ion-view>
