<ion-view title="{{ 'restaurantMenu' | translate }}" hide-back-button="true">

  <!-- - - - - - - - - - - - - - - - - - - NAV BAR - - - - - - - - - - - - - - - - - -->

  <ion-nav-buttons side="left">
    <button class="button button-clear ion-ios-arrow-back" on-tap="onLeaveRestaurant()"> {{ 'back' | translate }}
    </button>
  </ion-nav-buttons>

  <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

  <ge-loading-backdrop ng-show="loadingBackdrop.show">
  </ge-loading-backdrop>

  <!-- - - - - - - - - - - - - - - - - - - SUB HEADER BAR - - - - - - - - - - - - - - - - - -->
  <ion-content has-header="true" ng-hide="messageBackdrop.show">
    <div layout="row">
      <div flex class="rm-sub-header-content" ng-hide="isNewOrder.value">
        <h4 class="rm-sub-header-text">
          <i class="ion-arrow-graph-down-right energized"></i>
          {{ currentOrder.currentDiscount }} %
        </h4>
      </div>
      <div flex class="rm-sub-header-content" ng-hide="isNewOrder.value">
        <h4 class="rm-sub-header-text">
          <i class="ion-android-stopwatch energized"></i>
          <timer countdown="getTimeDiff(currentOrder.endingAt)" max-time-unit="'minute'" interval="1000" id="chrono-syle"> {{mminutes}}:{{sseconds}} </timer>
        </h4>
      </div>
      <div flex class="rm-sub-header-content">
        <h4 class="rm-sub-header-text">
          <ng-pluralize count="cart.getTotalQuantity()" when="{'0': ' 0 Pizza', '1': ' 1 Pizza', 'other': '{{ cart.getTotalQuantity() }} Pizzas'}" ></ng-pluralize>
        </h4>
      </div>
      <div flex class="rm-sub-header-content">
        <h4 class="rm-sub-header-text">
          {{ cart.getTotalPrice() | number : 2}}€
        </h4>
      </div>
    </div>

    <h6 class="rm-sub-header-energized-divider"></h6>
    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


    <!-- - - - - - - - - - - - - - - - - - - LIST OF PRODUCTS - - - - - - - - - - - - - - - - - -->
    <md-list>
      <md-list-item ng-repeat="product in products">

        <div layout="column" flex>
          <div layout="row" flex on-tap="toggleDetails(product)" ng-class="{active: areDetailsShown(product)}" >
            <div flex="90" class="md-tile-content">
              <h4> {{ product.name }} 
                <span class="gp-icon gp_vegie"></span> 
                <span class="gp-icon gp_pepper"></span>
              </h4>
              <h5> {{ product.description }} </h5>
            </div>
            <div flex="10" ng-show="cart.hasAtLeastOneProduct(product)" class="icon-height">
              <i class="icon ion-ios-checkmark-empty assertive"></i>
            </div>
          </div>

          <div layout="row" flex>
            <md-list flex>
              <md-list-item ng-repeat="format in product.formats.data" ng-show="areDetailsShown(product)">
                <div flex layout="row">
                  <div flex="60" ng-show="isNewOrder.value" class="md-tile-content">
                    {{ format.name }} ({{ format.price }} €)
                  </div>
                  <div flex="60" ng-hide="isNewOrder.value" class="md-tile-content">
                    {{ format.name }} (<strike>{{ format.price }}€</strike> {{ format.price*(100-currentOrder.currentDiscount)/100 | number : 2}} €)
                  </div>
                  <div flex="10">
                    <a class="ion-ios-minus-outline assertive icon-cart-add-delete align-right" on-tap="onDeleteProduct(product, format.id)"></a>
                  </div>
                  <div flex="10">
                    <a class="center">{{ cart.getFormatQuantity(format.id) }}</a>
                  </div>
                  <div flex="10">
                    <a class="icon ion-ios-plus-outline assertive icon-cart-add-delete" on-tap="onAddProduct(product, format)"></a>
                  </div>
                </div>
                <md-divider></md-divider>
              </md-list-item>
            </md-list>
          </div>
        </div>
      </md-list-item>
    </md-list>

    <div class="center cart-button">
      <style scoped>
      .md-button { padding: 3px; }
      .md-button.md-default-theme.md-fab { background-color: #e67e22; }
      </style>
      <md-button class="md-fab" ui-sref="cart">
        <i class="button button-clear ion-ios-cart-outline right-header-bar-icon" ></i>
      </md-button>
    </div>

  </ion-content>

<!-- - - - - - - - - - - - - - - - - - - BACKDROP MESSAGE - - - - - - - - - - - - - - - - - -->
  <ion-content has-header="true" scroll="false" ng-show="messageBackdrop.show">
    <ge-message-backdrop>
    </ge-message-backdrop>
  </ion-content>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

</ion-view>
