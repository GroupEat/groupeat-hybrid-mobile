<ion-view nav-bar-class="bar-transparent" hide-back-button="true">

  <!-- - - - - - - - - - - - - - - - - - - NAV BAR - - - - - - - - - - - - - - - - - -->

  <ion-nav-buttons side="primary">
    <button class="button button-clear button-icon button-back ion-ios-arrow-thin-left" on-tap="onLeaveRestaurant()"></button>
  </ion-nav-buttons>
  <ion-nav-title>
    <div class="title has-sub-title">
      Allo Pizza 91
      <small>12 Pizzas restantes</small>
    </div>
  </ion-nav-title>
  <ion-nav-buttons side="secondary" ng-if="currentOrder.endingAt">
    <button class="button button-clear">
      <timer end-time="currentOrder.endingAt" interval="1000"> {{mminutes}}:{{sseconds}}</timer>
    </button>
  </ion-nav-buttons>

  <!-- - - - - - - - - - - - - - - - - - - SUB HEADER BAR - - - - - - - - - - - - - - - - - -->
  <ion-content header-shrink="#discount-placeholder" class="no-header has-footer-summup full-height bg-blue">

    <div id="discount-placeholder">
      <div class="background" ng-style="{'background-image' : 'url(https://snap-photos.s3.amazonaws.com/img-thumbs/960w/9D0F9026F8.jpg)'}">
        <div class="content" id="discount-placeholder-content">
          <div class="discount" ng-show="currentOrder.currentDiscount">
            <h4>-{{ currentOrder.currentDiscount }}<small>%</small></h4>
          </div>
          <div class="food-rush">
            <h3 class="time-value">{{foodRushTime.value}}<small>mn</small></h3>
            <h5>{{ 'howLongFoodRush' | translate }} <b>Food Rush</b> ?</h5>
            <div class="item range range-assertive">
              5mn
              <input type="range" min="5" max="60" ng-model="foodRushTime.value" step="5" name="volume">
              60mn
            </div>
          </div>
        </div>
      </div>
    </div>

    <ion-list id="product-list">
      <div ng-repeat="product in products">
        <ion-item class="products" ng-click="toggleGroup(product)" ng-class="{'is-active': product.isShown}">
          <h4>{{product.name}}</h4>
          <p>{{product.description}}</p>
        </ion-item>
        <ion-item class="item-accordion" ng-repeat="format in product.formats.data" ng-class="{'is-active': product.isShown}">
          <div class="content">
            <div class="row">
              <div class="col-50">
                <div class="format-info">
                  <div class="clearfix">
                    <div class="pull-left">
                      <h5>{{ format.name }}</h5>
                    </div>
                    <div class="pull-right">
                      <div class="format-price">
                        <span ng-if="!currentOrder.currentDiscount">
                          <b>{{ format.price }}</b> €
                        </span>
                        <span ng-if="currentOrder.currentDiscount">
                          <strike>{{ format.price }}€</strike> <b>{{ format.price*(100-currentOrder.currentDiscount)/100 | number : 2}}</b> €
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
                
              </div>
              <div class="col-50">
                <div class="add-to-cart">
                  <div class="clearfix">
                    <a class="action-btn" ng-class="{'is-active' : cart.getFormatQuantity(format.id) > 0}" on-tap="onDeleteProduct(product, format.id)">
                      <i class="ion-ios-minus-empty"></i>
                    </a>
                    <a class="total">{{ cart.getFormatQuantity(format.id) }}</a>
                    <a class="action-btn is-active" on-tap="onAddProduct(product, format)">
                      <i class="ion-ios-plus-empty"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ion-item>
      </div>
    </ion-list>
  </ion-content>
  
  <div class="bar bar-white bar-footer bar-transparent bar-no-padding" id="summup-order">
    <div class="row row-no-padding">
      <div class="col">
        <div class="summup">
          <div class="clearfix">
            <div class="pull-left">
              <b>{{cart.getTotalQuantity()}}</b> 
              <ng-pluralize count="cart.getTotalQuantity()" when="{'0': 'Pizza', '1': 'Pizza', 'other': 'Pizzas'}" ></ng-pluralize>
            </div>
            <div class="pull-right">
              <b>{{ cart.getTotalPrice() | number : 2}}</b>€
            </div>
          </div>
        </div>
      </div>
      <div class="col">
        <a ui-sref="cart" class="btn btn-bloc btn-green btn-xlg btn-square">
          Commander
        </a>
      </div>
    </div>
  </div>

</ion-view>
